var __extends=this&&this.__extends||function(t,s){function e(){this.constructor=t}for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i]);t.prototype=null===s?Object.create(s):(e.prototype=s.prototype,new e)};define(["require","exports","std"],function(t,s,e){!function(t){t[t["SUM"]=0]="SUM",t[t["UNIQUE"]=1]="UNIQUE"}(s.CounterType||(s.CounterType={}));var i=s.CounterType,r=function(t){function s(s,e,r){void 0===e&&(e=s),void 0===r&&(r=i.SUM),t.call(this),this.key=s,this.label=e,this.type=r,this.uniques={},this.value=0}return __extends(s,t),s.prototype.go=function(t,s){return void 0===s&&(s=t),this.type==i.UNIQUE?this.uniques.hasOwnProperty(t)?this.uniques[t]:this.uniques[t]={key:t,label:s}:this.type==i.SUM?this.value+=t:void 0},s.prototype.getValue=function(){return this.value},s.prototype.getUniquesArray=function(t){var s=[];for(var e in this.uniques)s.push(this.uniques[e]);if(t){var i=s.sort(function(t,s){return t.label.compareToIgnoreCase(s.label)});s=[];for(var r=0;r<i.length;r++)s.push(i[r].key)}return s},s.prototype.getUniques=function(){return this.uniques},s.prototype.getUniquesCount=function(){return this.getUniquesArray().length},s}(e._Object),n=function(t){function s(s,e){void 0===s&&(s=""),void 0===e&&(e=s),t.call(this),this.key=s,this.label=e,this.uniques={},this.sums={},this.summaries={},this.ready=!1}return __extends(s,t),s.prototype.addUnique=function(t,s){void 0===s&&(s=t),this.ready=!0,this.uniques.hasOwnProperty(t)||(this.uniques[t]=new r(t,s,i.UNIQUE))},s.prototype.addSum=function(t,s){void 0===s&&(s=t),this.ready=!0,this.sums.hasOwnProperty(t)||(this.sums[t]=new r(t,s,i.SUM))},s.prototype.addSummary=function(t,e){return void 0===e&&(e=t),this.ready=!0,this.summaries.hasOwnProperty(t)?this.summaries[t]:this.summaries[t]=new s(this.key+"/"+t,e)},s.prototype.getItemLabel=function(t){if(void 0===t)return"";var s=t.split("/"),e=s.shift();return this.sums.hasOwnProperty(e)?this.sums[e].label:this.uniques.hasOwnProperty(e)?this.uniques[e].label:this.summaries.hasOwnProperty(e)?s.length>0?this.summaries[e].getItemLabel(s.join("/")):this.summaries[e].label:void 0},s.prototype.getRawItem=function(t){if(void 0===t)return null;var s=t.split("/"),e=s.shift();return this.sums.hasOwnProperty(e)?this.sums[e]:this.uniques.hasOwnProperty(e)?this.uniques[e]:this.summaries.hasOwnProperty(e)?s.length>0?this.summaries[e].getRawItem(s.join("/")):this.summaries[e]:void 0},s.prototype.getItem=function(t){if(void 0===t)return!1;var s=t.split("/"),e=s.shift();return this.sums.hasOwnProperty(e)?this.sums[e].getValue():this.uniques.hasOwnProperty(e)?this.uniques[e].getUniquesCount():this.summaries.hasOwnProperty(e)?s.length>0?this.summaries[e].getItem(s.join("/")):this.summaries[e]:void 0},s.prototype.go=function(t,s,e){if(void 0===e&&(e=s),void 0===t)return!1;if(void 0===s)return!1;var i=t.split("/"),r=i.shift();this.sums.hasOwnProperty(r)?this.sums[r].go(s):this.uniques.hasOwnProperty(r)?this.uniques[r].go(s,e):this.summaries.hasOwnProperty(r)&&this.summaries[r].go(i.join("/"),s,e)},s}(e._Object);s.Summary=n});